<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GPA & CGPA Calculator | Anna University R2021</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  background:#f4f6fb;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.card{
  background:#fff;
  width:95%;
  max-width:750px;
  padding:30px;
  border-radius:14px;
  box-shadow:0 15px 40px rgba(0,0,0,.12);
}

.header{
  text-align:center;
  margin-bottom:25px;
}
.header h1{
  margin:0;
  font-size:28px;
  color:#1d2671;
}
.header p{
  margin:6px 0 0;
  color:#555;
  font-size:14px;
}

label{
  display:block;
  margin-top:16px;
  font-weight:600;
  color:#333;
}

select,input{
  width:100%;
  padding:11px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:14px;
}

button{
  width:100%;
  margin-top:22px;
  padding:13px;
  background:linear-gradient(135deg,#1d2671,#3f51b5);
  color:#fff;
  border:none;
  border-radius:10px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}

button.secondary{
  background:#e0e3f5;
  color:#1d2671;
}

.page{display:none}

.subject{
  padding:10px;
  border-radius:8px;
  background:#f7f8ff;
  margin-top:12px;
}

.result{
  text-align:center;
  margin-top:20px;
  font-size:20px;
  font-weight:bold;
  color:#1d2671;
}

footer{
  text-align:center;
  font-size:13px;
  color:#444;
  margin-top:30px;
}

footer i{
  font-size:22px;
  margin:0 8px;
}

.fa-whatsapp{color:#25D366}
.fa-instagram{
  background:radial-gradient(circle at 30% 30%,#feda75,#fa7e1e,#d62976,#962fbf,#4f5bd5);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.fa-linkedin{color:#0A66C2}
.fa-phone{color:#2E7D32}
.fa-envelope{color:#D93025}
</style>
</head>

<body>
<div class="card">

<section id="page-welcome" class="page">
  <div class="header">
    <h1>GPA & CGPA Calculator</h1>
    <p>Computer Science and Engineering<br>Anna University – Regulation 2021</p>
  </div>

  <label>Student Name</label>
  <input id="studentName" placeholder="Enter your name">

  <label>Email Address</label>
  <input id="studentEmail" type="email" placeholder="Enter your email">

  <p style="font-size:12px;color:#666;margin-top:6px;">
    Your name and email are collected only for usage tracking. No data is shared.
  </p>

  <label>Number of Semesters Completed</label>
  <select id="semCompleted">
    <option value="">Select</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
  </select>

  <button onclick="startGPA()">Continue</button>
</section>

<section id="page-gpa" class="page">
  <div class="header">
    <h1 id="semTitle"></h1>
    <p id="userText"></p>
  </div>

  <div id="subjects"></div>

  <button onclick="calculateGPA()">Calculate GPA</button>
  <div id="result" class="result"></div>

  <button id="cgpaBtn" style="display:none" onclick="showCGPAPage()">Calculate CGPA</button>
  <button class="secondary" onclick="showPage('page-welcome')">Back to Menu</button>
</section>

<section id="page-cgpa" class="page">
  <div class="header">
    <h1>CGPA Calculator</h1>
  </div>

  <div id="cgpaInputs"></div>

  <button onclick="calculateCGPA()">Calculate CGPA</button>
  <div id="cgpaResult" class="result"></div>

  <button class="secondary" onclick="showPage('page-welcome')">Back to Menu</button>
</section>

<footer>
  This is created by <b>M Zia Anes</b><br><br>
  <a href="https://wa.me/919363645734"><i class="fab fa-whatsapp"></i></a>
  <a href="https://www.instagram.com/m_zia_anas"><i class="fab fa-instagram"></i></a>
  <a href="https://www.linkedin.com/in/zia-anes-m"><i class="fab fa-linkedin"></i></a>
  <a href="mailto:ziaanesm@gmail.com"><i class="fas fa-envelope"></i></a>
  <a href="tel:+919363645734"><i class="fas fa-phone"></i></a>
</footer>

</div>

<script>
function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
  document.getElementById(id).style.display="block";
}

/* ===== GOOGLE FORM TRACKING (CLOUDFLARE SAFE) ===== */
function trackUser(name, email) {
  const formURL =
    "https://docs.google.com/forms/d/13G9VlVwCaFFxzv--nK_RYLLyAFctqsxvm4JjzZxCZuQ/formResponse";

  const data = new URLSearchParams();
  data.append("entry.782499053", name);
  data.append("entry.1195044287", email);

  fetch(formURL, {
    method: "POST",
    mode: "no-cors",
    body: data
  });
}

let appState={name:"",semester:0,gpas:{}};

const gradePoints={O:10,"A+":9,A:8,"B+":7,B:6,C:5,RA:0};
const semesterCredits={1:22,2:26,3:23,4:22};

const curriculum={
1:[
{code:"HS3152",name:"Professional English I",credits:3},
{code:"MA3151",name:"Matrices and Calculus",credits:4},
{code:"PH3151",name:"Engineering Physics",credits:3},
{code:"CY3151",name:"Engineering Chemistry",credits:3},
{code:"GE3151",name:"Problem Solving and Python Programming",credits:3},
{code:"GE3152",name:"Heritage of Tamils",credits:1},
{code:"GE3171",name:"Problem Solving and Python Programming Laboratory",credits:2},
{code:"BS3171",name:"Physics and Chemistry Laboratory",credits:2},
{code:"GE3172",name:"English Laboratory",credits:1}
],
2:[
{code:"HS3252",name:"Professional English II",credits:2},
{code:"MA3251",name:"Statistics and Numerical Methods",credits:4},
{code:"PH3256",name:"Physics for Information Science",credits:3},
{code:"BE3251",name:"Basic Electrical and Electronics Engineering",credits:3},
{code:"GE3251",name:"Engineering Graphics",credits:4},
{code:"CS3251",name:"Programming in C",credits:3},
{code:"GE3252",name:"Tamils and Technology",credits:1},
{code:"GE3271",name:"Engineering Practices Laboratory",credits:2},
{code:"CS3271",name:"Programming in C Laboratory",credits:2},
{code:"GE3272",name:"Communication Laboratory",credits:2}
],
3:[
{code:"MA3354",name:"Discrete Mathematics",credits:4},
{code:"CS3351",name:"Digital Principles and Computer Organization",credits:4},
{code:"CS3352",name:"Foundations of Data Science",credits:3},
{code:"CS3301",name:"Data Structures",credits:3},
{code:"CS3391",name:"Object Oriented Programming",credits:3},
{code:"CS3311",name:"Data Structures Laboratory",credits:1.5},
{code:"CS3381",name:"Object Oriented Programming Laboratory",credits:1.5},
{code:"CS3361",name:"Data Science Laboratory",credits:2},
{code:"GE3361",name:"Professional Development",credits:1}
],
4:[
{code:"CS3452",name:"Theory of Computation",credits:3},
{code:"CS3491",name:"Artificial Intelligence and Machine Learning",credits:4},
{code:"CS3492",name:"Database Management Systems",credits:3},
{code:"CS3401",name:"Algorithms",credits:4},
{code:"CS3451",name:"Introduction to Operating Systems",credits:3},
{code:"GE3451",name:"Environmental Sciences and Sustainability",credits:2},
{code:"CS3461",name:"Operating Systems Laboratory",credits:1.5},
{code:"CS3481",name:"Database Management Systems Laboratory",credits:1.5}
]
};

function startGPA(){
  const n=document.getElementById("studentName").value.trim();
  const e=document.getElementById("studentEmail").value.trim();
  const s=document.getElementById("semCompleted").value;

  if(!n||!e||!s){
    alert("Please enter Name, Email and Semester");
    return;
  }

  trackUser(n,e);

  appState.name=n;
  appState.semester=parseInt(s);
  loadSemester();
}

function loadSemester(){
  document.getElementById("semTitle").innerText=`Semester ${appState.semester} GPA`;
  document.getElementById("userText").innerText=`Hello ${appState.name}`;
  document.getElementById("result").innerHTML="";
  const box=document.getElementById("subjects");
  box.innerHTML="";
  curriculum[appState.semester].forEach(sub=>{
    box.innerHTML+=`
      <div class="subject">
        <label>${sub.code} – ${sub.name} (Credits: ${sub.credits})</label>
        <select id="${sub.code}">
          <option value="">Select Grade</option>
          <option>O</option><option>A+</option><option>A</option>
          <option>B+</option><option>B</option><option>C</option><option>RA</option>
        </select>
      </div>`;
  });
  document.getElementById("cgpaBtn").style.display=appState.semester>=2?"block":"none";
  showPage("page-gpa");
}

function calculateGPA(){
  let tc=0,tp=0;
  for(const s of curriculum[appState.semester]){
    const g=document.getElementById(s.code).value;
    if(!g){alert("Please select all grades");return;}
    tc+=s.credits;
    tp+=gradePoints[g]*s.credits;
  }
  const gpa=(tp/tc).toFixed(2);
  appState.gpas[appState.semester]=parseFloat(gpa);
  document.getElementById("result").innerText=`GPA : ${gpa}`;
}

function showCGPAPage(){
  let html="";
  for(let i=1;i<=appState.semester;i++){
    html+=`
      <label>Semester ${i} GPA</label>
      <input type="number" step="0.01" id="gpa${i}" value="${appState.gpas[i]??""}">
    `;
  }
  document.getElementById("cgpaInputs").innerHTML=html;
  showPage("page-cgpa");
}

function calculateCGPA(){
  let total=0,credits=0;
  for(let i=1;i<=appState.semester;i++){
    const g=parseFloat(document.getElementById(\`gpa\${i}\`).value);
    if(isNaN(g)){alert("Please enter all GPAs");return;}
    total+=g*semesterCredits[i];
    credits+=semesterCredits[i];
  }
  document.getElementById("cgpaResult").innerText=\`CGPA : \${(total/credits).toFixed(2)}\`;
}

showPage("page-welcome");
</script>

</body>
</html>
